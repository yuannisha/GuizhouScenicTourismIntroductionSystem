{"version":3,"file":"list.js","sources":["pages/food/list.vue","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZm9vZC9saXN0LnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"food-list-container\">\r\n\t\t<!-- 搜索栏 -->\r\n\t\t<view class=\"search-bar\">\r\n\t\t\t<input type=\"text\" v-model=\"searchKeyword\" placeholder=\"搜索美食\" />\r\n\t\t\t<button @click=\"handleSearch\">搜索</button>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 分类标签 -->\r\n\t\t<scroll-view class=\"category-scroll\" scroll-x>\r\n\t\t\t<view class=\"category-list\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tclass=\"category-item\" \r\n\t\t\t\t\t:class=\"{ active: currentCategory === item.id }\"\r\n\t\t\t\t\tv-for=\"(item, index) in categoryList\" \r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t@click=\"handleCategoryChange(item)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{{item.name}}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t\t\r\n\t\t<!-- 美食列表 -->\r\n\t\t<scroll-view \r\n\t\t\tclass=\"food-list\"\r\n\t\t\tscroll-y\r\n\t\t\t@scrolltolower=\"loadMore\"\r\n\t\t\t:style=\"{ height: listHeight + 'px' }\"\r\n\t\t>\r\n\t\t\t<view \r\n\t\t\t\tclass=\"food-item\"\r\n\t\t\t\tv-for=\"(item, index) in foodList\"\r\n\t\t\t\t:key=\"index\"\r\n\t\t\t\t@click=\"goToDetail(item)\"\r\n\t\t\t>\r\n\t\t\t\t<image :src=\"item.cover\" mode=\"aspectFill\"></image>\r\n\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t<view class=\"name-price\">\r\n\t\t\t\t\t\t<text class=\"name\">{{item.name}}</text>\r\n\t\t\t\t\t\t<text class=\"price\">¥{{item.price}}起</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text class=\"location\">{{item.location}}</text>\r\n\t\t\t\t\t<text class=\"description\">{{item.description}}</text>\r\n\t\t\t\t\t<view class=\"tags\">\r\n\t\t\t\t\t\t<text v-for=\"(tag, tagIndex) in item.tags\" :key=\"tagIndex\">{{tag}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 加载状态 -->\r\n\t\t\t<view class=\"loading-status\">\r\n\t\t\t\t<text v-if=\"loading\">加载中...</text>\r\n\t\t\t\t<text v-else-if=\"noMore\">没有更多了</text>\r\n\t\t\t\t<text v-else-if=\"foodList.length === 0\">暂无数据</text>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n/**\r\n * 美食列表页面\r\n * @description 展示美食列表，支持分类筛选和搜索\r\n */\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tsearchKeyword: '',\r\n\t\t\tcurrentCategory: 0,\r\n\t\t\tcategoryList: [\r\n\t\t\t\t{ id: 0, name: '全部' },\r\n\t\t\t\t{ id: 1, name: '特色小吃' },\r\n\t\t\t\t{ id: 2, name: '地方菜系' },\r\n\t\t\t\t{ id: 3, name: '传统美食' },\r\n\t\t\t\t{ id: 4, name: '创新菜品' }\r\n\t\t\t],\r\n\t\t\tfoodList: [],\r\n\t\t\tpage: 1,\r\n\t\t\tpageSize: 10,\r\n\t\t\tloading: false,\r\n\t\t\tnoMore: false,\r\n\t\t\tlistHeight: 0\r\n\t\t}\r\n\t},\r\n\tonLoad() {\r\n\t\t// 计算列表高度\r\n\t\tconst systemInfo = uni.getSystemInfoSync()\r\n\t\t// 减去搜索栏和分类标签的高度\r\n\t\tthis.listHeight = systemInfo.windowHeight - uni.upx2px(180)\r\n\t\t\r\n\t\tthis.loadFoodList()\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 加载美食列表\r\n\t\t */\r\n\t\tasync loadFoodList() {\r\n\t\t\tif (this.loading || this.noMore) return\r\n\t\t\t\r\n\t\t\tthis.loading = true\r\n\t\t\tconsole.log(\"当前分类\",this.currentCategory)\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await uniCloud.callFunction({\r\n\t\t\t\t\tname: 'food-center',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'getFoodList',\r\n\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\tUSERID: uni.getStorageSync('userInfo')._id,\r\n\t\t\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\t\t\t\tcategory: this.currentCategory,\r\n\t\t\t\t\t\t\tkeyword: this.searchKeyword\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif (res.result.code === 0) {\r\n\t\t\t\t\tconst { list, total } = res.result.data\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (this.page === 1) {\r\n\t\t\t\t\t\tthis.foodList = list\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.foodList = [...this.foodList, ...list]\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.noMore = this.foodList.length >= total\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: res.result.message || '加载失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '加载失败，请稍后重试',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\tconsole.error(e)\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loading = false\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 处理搜索\r\n\t\t */\r\n\t\thandleSearch() {\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.noMore = false\r\n\t\t\tthis.loadFoodList()\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 处理分类切换\r\n\t\t */\r\n\t\thandleCategoryChange(category) {\r\n\t\t\tthis.currentCategory = category.id\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.noMore = false\r\n\t\t\tthis.loadFoodList()\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 加载更多\r\n\t\t */\r\n\t\tloadMore() {\r\n\t\t\tif (!this.loading && !this.noMore) {\r\n\t\t\t\tthis.page++\r\n\t\t\t\tthis.loadFoodList()\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 跳转到详情页\r\n\t\t */\r\n\t\tgoToDetail(item) {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/food/detail?id=${item._id}`\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.food-list-container {\r\n\tmin-height: 100vh;\r\n\tbackground-color: #f5f5f5;\r\n\t\r\n\t.search-bar {\r\n\t\tdisplay: flex;\r\n\t\tpadding: 20rpx;\r\n\t\tbackground-color: #fff;\r\n\t\t\r\n\t\tinput {\r\n\t\t\tflex: 1;\r\n\t\t\theight: 72rpx;\r\n\t\t\tpadding: 0 20rpx;\r\n\t\t\tbackground-color: #f5f5f5;\r\n\t\t\tborder-radius: 36rpx;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t}\r\n\t\t\r\n\t\tbutton {\r\n\t\t\twidth: 120rpx;\r\n\t\t\theight: 72rpx;\r\n\t\t\tmargin-left: 20rpx;\r\n\t\t\tline-height: 72rpx;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #fff;\r\n\t\t\tbackground-color: #007AFF;\r\n\t\t\tborder-radius: 36rpx;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.category-scroll {\r\n\t\tbackground-color: #fff;\r\n\t\twhite-space: nowrap;\r\n\t\t\r\n\t\t.category-list {\r\n\t\t\tdisplay: flex;\r\n\t\t\tpadding: 20rpx;\r\n\t\t\t\r\n\t\t\t.category-item {\r\n\t\t\t\tpadding: 10rpx 30rpx;\r\n\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t\tbackground-color: #f5f5f5;\r\n\t\t\t\tborder-radius: 30rpx;\r\n\t\t\t\t\r\n\t\t\t\t&.active {\r\n\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t\tbackground-color: #007AFF;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t&:last-child {\r\n\t\t\t\t\tmargin-right: 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t.food-list {\r\n\t\tpadding: 20rpx;\r\n\t\tbox-sizing: border-box;\r\n\t\t\r\n\t\t.food-item {\r\n\t\t\tdisplay: flex;\r\n\t\t\tpadding: 20rpx;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tborder-radius: 12rpx;\r\n\t\t\t\r\n\t\t\timage {\r\n\t\t\t\twidth: 200rpx;\r\n\t\t\t\theight: 200rpx;\r\n\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.info {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\t\r\n\t\t\t\t.name-price {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tjustify-content: space-between;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t\r\n\t\t\t\t\t.name {\r\n\t\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\t\tcolor: #333;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t.price {\r\n\t\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\t\tcolor: #ff4d4f;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.location {\r\n\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\tcolor: #666;\r\n\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.description {\r\n\t\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\t\tcolor: #666;\r\n\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.tags {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\t\t\r\n\t\t\t\t\ttext {\r\n\t\t\t\t\t\tpadding: 4rpx 12rpx;\r\n\t\t\t\t\t\tmargin-right: 10rpx;\r\n\t\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t\tfont-size: 22rpx;\r\n\t\t\t\t\t\tcolor: #007AFF;\r\n\t\t\t\t\t\tbackground-color: rgba(0, 122, 255, 0.1);\r\n\t\t\t\t\t\tborder-radius: 4rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t.loading-status {\r\n\t\t\ttext-align: center;\r\n\t\t\tpadding: 20rpx;\r\n\t\t\t\r\n\t\t\ttext {\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tcolor: #999;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</style> ","import MiniProgramPage from 'D:/programs2024to2025/liululuprogram/first/GuizhouScenicTourismIntroductionSystem/pages/food/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":";;AAiEA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,eAAe;AAAA,MACf,iBAAiB;AAAA,MACjB,cAAc;AAAA,QACb,EAAE,IAAI,GAAG,MAAM,KAAM;AAAA,QACrB,EAAE,IAAI,GAAG,MAAM,OAAQ;AAAA,QACvB,EAAE,IAAI,GAAG,MAAM,OAAQ;AAAA,QACvB,EAAE,IAAI,GAAG,MAAM,OAAQ;AAAA,QACvB,EAAE,IAAI,GAAG,MAAM,OAAO;AAAA,MACtB;AAAA,MACD,UAAU,CAAE;AAAA,MACZ,MAAM;AAAA,MACN,UAAU;AAAA,MACV,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,YAAY;AAAA,IACb;AAAA,EACA;AAAA,EACD,SAAS;AAER,UAAM,aAAaA,cAAG,MAAC,kBAAkB;AAEzC,SAAK,aAAa,WAAW,eAAeA,cAAG,MAAC,OAAO,GAAG;AAE1D,SAAK,aAAa;AAAA,EAClB;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA,IAIR,MAAM,eAAe;AACpB,UAAI,KAAK,WAAW,KAAK;AAAQ;AAEjC,WAAK,UAAU;AACfA,oBAAY,MAAA,MAAA,OAAA,8BAAA,QAAO,KAAK,eAAe;AAEvC,UAAI;AACH,cAAM,MAAM,MAAMC,cAAQ,GAAC,aAAa;AAAA,UACvC,MAAM;AAAA,UACN,MAAM;AAAA,YACL,QAAQ;AAAA,YACR,QAAQ;AAAA,cACP,QAAQD,cAAG,MAAC,eAAe,UAAU,EAAE;AAAA,cACvC,MAAM,KAAK;AAAA,cACX,UAAU,KAAK;AAAA,cACf,UAAU,KAAK;AAAA,cACf,SAAS,KAAK;AAAA,YACf;AAAA,UACD;AAAA,SACA;AAED,YAAI,IAAI,OAAO,SAAS,GAAG;AAC1B,gBAAM,EAAE,MAAM,MAAQ,IAAE,IAAI,OAAO;AAEnC,cAAI,KAAK,SAAS,GAAG;AACpB,iBAAK,WAAW;AAAA,iBACV;AACN,iBAAK,WAAW,CAAC,GAAG,KAAK,UAAU,GAAG,IAAI;AAAA,UAC3C;AAEA,eAAK,SAAS,KAAK,SAAS,UAAU;AAAA,eAChC;AACNA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO,IAAI,OAAO,WAAW;AAAA,YAC7B,MAAM;AAAA,WACN;AAAA,QACF;AAAA,MACD,SAAS,GAAG;AACXA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,SACN;AACDA,sBAAAA,MAAc,MAAA,SAAA,8BAAA,CAAC;AAAA,MAChB,UAAU;AACT,aAAK,UAAU;AAAA,MAChB;AAAA,IACA;AAAA;AAAA;AAAA;AAAA,IAKD,eAAe;AACd,WAAK,OAAO;AACZ,WAAK,SAAS;AACd,WAAK,aAAa;AAAA,IAClB;AAAA;AAAA;AAAA;AAAA,IAKD,qBAAqB,UAAU;AAC9B,WAAK,kBAAkB,SAAS;AAChC,WAAK,OAAO;AACZ,WAAK,SAAS;AACd,WAAK,aAAa;AAAA,IAClB;AAAA;AAAA;AAAA;AAAA,IAKD,WAAW;AACV,UAAI,CAAC,KAAK,WAAW,CAAC,KAAK,QAAQ;AAClC,aAAK;AACL,aAAK,aAAa;AAAA,MACnB;AAAA,IACA;AAAA;AAAA;AAAA;AAAA,IAKD,WAAW,MAAM;AAChBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,yBAAyB,KAAK,GAAG;AAAA,OACtC;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtLA,GAAG,WAAW,eAAe;"}