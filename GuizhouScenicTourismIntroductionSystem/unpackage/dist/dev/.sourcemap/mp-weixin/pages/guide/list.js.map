{"version":3,"file":"list.js","sources":["pages/guide/list.vue","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZ3VpZGUvbGlzdC52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"guide-list-container\">\r\n\t\t<!-- 搜索栏 -->\r\n\t\t<view class=\"search-bar\">\r\n\t\t\t<input type=\"text\" v-model=\"keyword\" placeholder=\"搜索攻略\" />\r\n\t\t\t<button @click=\"handleSearch\">搜索</button>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 标签列表 -->\r\n\t\t<scroll-view \r\n\t\t\tclass=\"tags-scroll\" \r\n\t\t\tscroll-x=\"true\" \r\n\t\t\tshow-scrollbar=\"false\"\r\n\t\t>\r\n\t\t\t<view class=\"tags-list\">\r\n\t\t\t\t<text \r\n\t\t\t\t\tclass=\"tag-item\" \r\n\t\t\t\t\t:class=\"{ active: currentTag === '' }\"\r\n\t\t\t\t\t@click=\"handleTagChange('')\"\r\n\t\t\t\t>全部</text>\r\n\t\t\t\t<text \r\n\t\t\t\t\tv-for=\"(tag, index) in tags\" \r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\tclass=\"tag-item\"\r\n\t\t\t\t\t:class=\"{ active: currentTag === tag }\"\r\n\t\t\t\t\t@click=\"handleTagChange(tag)\"\r\n\t\t\t\t>{{tag}}</text>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t\t\r\n\t\t<!-- 攻略列表 -->\r\n\t\t<scroll-view \r\n\t\t\tclass=\"guide-scroll\"\r\n\t\t\tscroll-y=\"true\"\r\n\t\t\t@scrolltolower=\"loadMore\"\r\n\t\t\trefresher-enabled\r\n\t\t\t:refresher-triggered=\"isRefreshing\"\r\n\t\t\t@refresherrefresh=\"refresh\"\r\n\t\t>\r\n\t\t\t<view class=\"guide-list\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tclass=\"guide-item\"\r\n\t\t\t\t\tv-for=\"(item, index) in guideList\"\r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t@click=\"goDetail(item._id)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<image \r\n\t\t\t\t\t\tclass=\"cover\"\r\n\t\t\t\t\t\t:src=\"item.cover || '/static/default-cover.png'\"\r\n\t\t\t\t\t\tmode=\"aspectFill\"\r\n\t\t\t\t\t></image>\r\n\t\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t\t<text class=\"name\">{{item.name}}</text>\r\n\t\t\t\t\t\t<text class=\"description\">{{item.description}}</text>\r\n\t\t\t\t\t\t<view class=\"tags\">\r\n\t\t\t\t\t\t\t<text v-for=\"(tag, tagIndex) in item.tags\" :key=\"tagIndex\">{{tag}}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"stats\">\r\n\t\t\t\t\t\t\t<text class=\"views\">{{item.views}}浏览</text>\r\n\t\t\t\t\t\t\t<text class=\"likes\">{{item.likes}}点赞</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 加载状态 -->\r\n\t\t\t<view class=\"loading-status\">\r\n\t\t\t\t<view v-if=\"loading\" class=\"loading\">加载中...</view>\r\n\t\t\t\t<view v-else-if=\"!hasMore\" class=\"no-more\">没有更多了</view>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n/**\r\n * 攻略列表页面\r\n * @description 展示攻略列表,支持搜索、标签筛选、下拉刷新、上拉加载更多\r\n */\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tkeyword: '',\r\n\t\t\tcurrentTag: '',\r\n\t\t\ttags: ['美食', '景点', '住宿', '交通', '购物', '娱乐'],\r\n\t\t\tguideList: [],\r\n\t\t\tpage: 1,\r\n\t\t\tpageSize: 10,\r\n\t\t\tloading: false,\r\n\t\t\thasMore: true,\r\n\t\t\tisRefreshing: false,\r\n\t\t\ttotal: 0\r\n\t\t}\r\n\t},\r\n\tonLoad() {\r\n\t\tthis.loadGuideList()\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 加载攻略列表\r\n\t\t */\r\n\t\tasync loadGuideList() {\r\n\t\t\tif (this.loading || !this.hasMore) return\r\n\t\t\t\r\n\t\t\tthis.loading = true\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await uniCloud.callFunction({\r\n\t\t\t\t\tname: 'guide-center',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'getGuideList',\r\n\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\tUSERID: uni.getStorageSync('userInfo')?._id,\r\n\t\t\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\t\t\t\tkeyword: this.keyword,\r\n\t\t\t\t\t\t\ttag: this.currentTag\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif (res.result.code === 0) {\r\n\t\t\t\t\tconst { list, total } = res.result.data\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (this.page === 1) {\r\n\t\t\t\t\t\tthis.guideList = list\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.guideList = [...this.guideList, ...list]\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.total = total\r\n\t\t\t\t\tthis.hasMore = this.guideList.length < total\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: res.result.message || '加载失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '加载失败',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\tconsole.error(e)\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loading = false\r\n\t\t\t\tthis.isRefreshing = false\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 处理搜索\r\n\t\t */\r\n\t\thandleSearch() {\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.hasMore = true\r\n\t\t\tthis.loadGuideList()\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 处理标签切换\r\n\t\t */\r\n\t\thandleTagChange(tag) {\r\n\t\t\tthis.currentTag = tag\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.hasMore = true\r\n\t\t\tthis.loadGuideList()\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 加载更多\r\n\t\t */\r\n\t\tloadMore() {\r\n\t\t\tif (this.hasMore) {\r\n\t\t\t\tthis.page++\r\n\t\t\t\tthis.loadGuideList()\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 刷新列表\r\n\t\t */\r\n\t\tasync refresh() {\r\n\t\t\tthis.isRefreshing = true\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.hasMore = true\r\n\t\t\tawait this.loadGuideList()\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 跳转到详情页\r\n\t\t */\r\n\t\tgoDetail(id) {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/guide/detail?id=${id}`\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.guide-list-container {\r\n\tmin-height: 100vh;\r\n\tbackground-color: #f5f5f5;\r\n\t\r\n\t.search-bar {\r\n\t\tdisplay: flex;\r\n\t\tpadding: 20rpx;\r\n\t\tbackground-color: #fff;\r\n\t\t\r\n\t\tinput {\r\n\t\t\tflex: 1;\r\n\t\t\theight: 72rpx;\r\n\t\t\tpadding: 0 20rpx;\r\n\t\t\tbackground-color: #f5f5f5;\r\n\t\t\tborder-radius: 36rpx;\r\n\t\t\tmargin-right: 20rpx;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t}\r\n\t\t\r\n\t\tbutton {\r\n\t\t\twidth: 120rpx;\r\n\t\t\theight: 72rpx;\r\n\t\t\tline-height: 72rpx;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #fff;\r\n\t\t\tbackground-color: #007AFF;\r\n\t\t\tborder-radius: 36rpx;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.tags-scroll {\r\n\t\tbackground-color: #fff;\r\n\t\twhite-space: nowrap;\r\n\t\t\r\n\t\t.tags-list {\r\n\t\t\tdisplay: inline-flex;\r\n\t\t\tpadding: 20rpx;\r\n\t\t\t\r\n\t\t\t.tag-item {\r\n\t\t\t\tpadding: 8rpx 24rpx;\r\n\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t\tbackground-color: #f5f5f5;\r\n\t\t\t\tborder-radius: 28rpx;\r\n\t\t\t\t\r\n\t\t\t\t&.active {\r\n\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t\tbackground-color: #007AFF;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t&:last-child {\r\n\t\t\t\t\tmargin-right: 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t.guide-scroll {\r\n\t\theight: calc(100vh - 200rpx);\r\n\t\t\r\n\t\t.guide-list {\r\n\t\t\tpadding: 20rpx;\r\n\t\t\t\r\n\t\t\t.guide-item {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tpadding: 20rpx;\r\n\t\t\t\tmargin-bottom: 20rpx;\r\n\t\t\t\tbackground-color: #fff;\r\n\t\t\t\tborder-radius: 12rpx;\r\n\t\t\t\t\r\n\t\t\t\t.cover {\r\n\t\t\t\t\twidth: 200rpx;\r\n\t\t\t\t\theight: 200rpx;\r\n\t\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.info {\r\n\t\t\t\t\tflex: 1;\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tflex-direction: column;\r\n\t\t\t\t\t\r\n\t\t\t\t\t.name {\r\n\t\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\t\tcolor: #333;\r\n\t\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t.description {\r\n\t\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\t\tcolor: #666;\r\n\t\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t\tdisplay: -webkit-box;\r\n\t\t\t\t\t\t-webkit-box-orient: vertical;\r\n\t\t\t\t\t\t-webkit-line-clamp: 2;\r\n\t\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t.tags {\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\ttext {\r\n\t\t\t\t\t\t\tpadding: 4rpx 16rpx;\r\n\t\t\t\t\t\t\tmargin-right: 16rpx;\r\n\t\t\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\t\t\tcolor: #007AFF;\r\n\t\t\t\t\t\t\tbackground-color: rgba(0, 122, 255, 0.1);\r\n\t\t\t\t\t\t\tborder-radius: 4rpx;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t.stats {\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\t\tcolor: #999;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t.views {\r\n\t\t\t\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t.loading-status {\r\n\t\t\tpadding: 20rpx;\r\n\t\t\ttext-align: center;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #999;\r\n\t\t}\r\n\t}\r\n}\r\n</style> ","import MiniProgramPage from 'D:/programs2024to2025/liululuprogram/first/GuizhouScenicTourismIntroductionSystem/pages/guide/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","uni"],"mappings":";;AA+EA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,SAAS;AAAA,MACT,YAAY;AAAA,MACZ,MAAM,CAAC,MAAM,MAAM,MAAM,MAAM,MAAM,IAAI;AAAA,MACzC,WAAW,CAAE;AAAA,MACb,MAAM;AAAA,MACN,UAAU;AAAA,MACV,SAAS;AAAA,MACT,SAAS;AAAA,MACT,cAAc;AAAA,MACd,OAAO;AAAA,IACR;AAAA,EACA;AAAA,EACD,SAAS;AACR,SAAK,cAAc;AAAA,EACnB;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA,IAIR,MAAM,gBAAgB;;AACrB,UAAI,KAAK,WAAW,CAAC,KAAK;AAAS;AAEnC,WAAK,UAAU;AAEf,UAAI;AACH,cAAM,MAAM,MAAMA,cAAQ,GAAC,aAAa;AAAA,UACvC,MAAM;AAAA,UACN,MAAM;AAAA,YACL,QAAQ;AAAA,YACR,QAAQ;AAAA,cACP,SAAQC,mBAAG,MAAC,eAAe,UAAU,MAA7BA,mBAAgC;AAAA,cACxC,MAAM,KAAK;AAAA,cACX,UAAU,KAAK;AAAA,cACf,SAAS,KAAK;AAAA,cACd,KAAK,KAAK;AAAA,YACX;AAAA,UACD;AAAA,SACA;AAED,YAAI,IAAI,OAAO,SAAS,GAAG;AAC1B,gBAAM,EAAE,MAAM,MAAQ,IAAE,IAAI,OAAO;AAEnC,cAAI,KAAK,SAAS,GAAG;AACpB,iBAAK,YAAY;AAAA,iBACX;AACN,iBAAK,YAAY,CAAC,GAAG,KAAK,WAAW,GAAG,IAAI;AAAA,UAC7C;AAEA,eAAK,QAAQ;AACb,eAAK,UAAU,KAAK,UAAU,SAAS;AAAA,eACjC;AACNA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO,IAAI,OAAO,WAAW;AAAA,YAC7B,MAAM;AAAA,WACN;AAAA,QACF;AAAA,MACD,SAAS,GAAG;AACXA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,SACN;AACDA,sBAAAA,MAAc,MAAA,SAAA,+BAAA,CAAC;AAAA,MAChB,UAAU;AACT,aAAK,UAAU;AACf,aAAK,eAAe;AAAA,MACrB;AAAA,IACA;AAAA;AAAA;AAAA;AAAA,IAKD,eAAe;AACd,WAAK,OAAO;AACZ,WAAK,UAAU;AACf,WAAK,cAAc;AAAA,IACnB;AAAA;AAAA;AAAA;AAAA,IAKD,gBAAgB,KAAK;AACpB,WAAK,aAAa;AAClB,WAAK,OAAO;AACZ,WAAK,UAAU;AACf,WAAK,cAAc;AAAA,IACnB;AAAA;AAAA;AAAA;AAAA,IAKD,WAAW;AACV,UAAI,KAAK,SAAS;AACjB,aAAK;AACL,aAAK,cAAc;AAAA,MACpB;AAAA,IACA;AAAA;AAAA;AAAA;AAAA,IAKD,MAAM,UAAU;AACf,WAAK,eAAe;AACpB,WAAK,OAAO;AACZ,WAAK,UAAU;AACf,YAAM,KAAK,cAAc;AAAA,IACzB;AAAA;AAAA;AAAA;AAAA,IAKD,SAAS,IAAI;AACZA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,0BAA0B,EAAE;AAAA,OACjC;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrMA,GAAG,WAAW,eAAe;"}