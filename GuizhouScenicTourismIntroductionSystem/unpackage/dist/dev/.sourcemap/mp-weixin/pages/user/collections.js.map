{"version":3,"file":"collections.js","sources":["pages/user/collections.vue","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9jb2xsZWN0aW9ucy52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"collections-container\">\r\n\t\t<!-- 分类标签 -->\r\n\t\t<scroll-view class=\"category-scroll\" scroll-x>\r\n\t\t\t<view class=\"category-list\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tclass=\"category-item\" \r\n\t\t\t\t\t:class=\"{ active: currentCategory === item.value }\"\r\n\t\t\t\t\tv-for=\"item in categories\" \r\n\t\t\t\t\t:key=\"item.value\"\r\n\t\t\t\t\t@click=\"handleCategoryChange(item.value)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{{item.name}}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t\t\r\n\t\t<!-- 收藏列表 -->\r\n\t\t<scroll-view \r\n\t\t\tclass=\"collection-list\"\r\n\t\t\tscroll-y\r\n\t\t\t@scrolltolower=\"loadMore\"\r\n\t\t\trefresher-enabled\r\n\t\t\t:refresher-triggered=\"isRefreshing\"\r\n\t\t\t@refresherrefresh=\"refresh\"\r\n\t\t>\r\n\t\t\t<!-- 景点收藏 -->\r\n\t\t\t<view v-if=\"currentCategory === 'scenic'\" class=\"collection-items\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tclass=\"scenic-item\"\r\n\t\t\t\t\tv-for=\"(item, index) in collectionList\"\r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t@click=\"goToDetail(item)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<image :src=\"item.cover\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t\t<text class=\"name\">{{item.name}}</text>\r\n\t\t\t\t\t\t<text class=\"location\">{{item.location}}</text>\r\n\t\t\t\t\t\t<text class=\"price\">¥{{item.price}}起</text>\r\n\t\t\t\t\t\t<view class=\"tags\">\r\n\t\t\t\t\t\t\t<text v-for=\"(tag, tagIndex) in item.tags\" :key=\"tagIndex\">{{tag}}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 美食收藏 -->\r\n\t\t\t<view v-if=\"currentCategory === 'food'\" class=\"collection-items\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tclass=\"food-item\"\r\n\t\t\t\t\tv-for=\"(item, index) in collectionList\"\r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t@click=\"goToDetail(item)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<image :src=\"item.cover\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t\t<text class=\"name\">{{item.name}}</text>\r\n\t\t\t\t\t\t<text class=\"location\">{{item.location}}</text>\r\n\t\t\t\t\t\t<text class=\"price\">¥{{item.price}}</text>\r\n\t\t\t\t\t\t<view class=\"tags\">\r\n\t\t\t\t\t\t\t<text v-for=\"(tag, tagIndex) in item.tags\" :key=\"tagIndex\">{{tag}}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 文化收藏 -->\r\n\t\t\t<view v-if=\"currentCategory === 'culture'\" class=\"collection-items\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tclass=\"culture-item\"\r\n\t\t\t\t\tv-for=\"(item, index) in collectionList\"\r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t@click=\"goToDetail(item)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<image :src=\"item.cover\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t\t<text class=\"name\">{{item.name}}</text>\r\n\t\t\t\t\t\t<text class=\"description\">{{item.description}}</text>\r\n\t\t\t\t\t\t<view class=\"tags\">\r\n\t\t\t\t\t\t\t<text v-for=\"(tag, tagIndex) in item.tags\" :key=\"tagIndex\">{{tag}}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 攻略收藏 -->\r\n\t\t\t<view v-if=\"currentCategory === 'guide'\" class=\"collection-items\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tclass=\"guide-item\"\r\n\t\t\t\t\tv-for=\"(item, index) in collectionList\"\r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t@click=\"goToDetail(item)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<image :src=\"item.cover\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t\t<text class=\"name\">{{item.name}}</text>\r\n\t\t\t\t\t\t<text class=\"description\">{{item.description}}</text>\r\n\t\t\t\t\t\t<view class=\"bottom\">\r\n\t\t\t\t\t\t\t<view class=\"tags\">\r\n\t\t\t\t\t\t\t\t<text v-for=\"(tag, tagIndex) in item.tags\" :key=\"tagIndex\">{{tag}}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<text class=\"views\">{{item.views}}浏览</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 加载状态 -->\r\n\t\t\t<view class=\"loading-status\">\r\n\t\t\t\t<text v-if=\"loading\">加载中...</text>\r\n\t\t\t\t<text v-else-if=\"noMore\">没有更多了</text>\r\n\t\t\t\t<text v-else-if=\"collectionList.length === 0\">暂无收藏</text>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n/**\r\n * 我的收藏页面\r\n * @description 展示用户收藏的景点、美食、文化和攻略\r\n */\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcategories: [\r\n\t\t\t\t{ name: '景点', value: 'scenic' },\r\n\t\t\t\t{ name: '美食', value: 'food' },\r\n\t\t\t\t{ name: '文化', value: 'culture' },\r\n\t\t\t\t{ name: '攻略', value: 'guide' }\r\n\t\t\t],\r\n\t\t\tcurrentCategory: 'scenic',\r\n\t\t\tcollectionList: [],\r\n\t\t\tpage: 1,\r\n\t\t\tpageSize: 10,\r\n\t\t\tloading: false,\r\n\t\t\tnoMore: false,\r\n\t\t\tisRefreshing: false\r\n\t\t}\r\n\t},\r\n\tonLoad() {\r\n\t\tthis.loadCollections()\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 加载收藏列表\r\n\t\t */\r\n\t\tasync loadCollections() {\r\n\t\t\tif (this.loading || this.noMore) return\r\n\t\t\t\r\n\t\t\tthis.loading = true\r\n            console.log(\"当前分类\",this.currentCategory)\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await uniCloud.callFunction({\r\n\t\t\t\t\tname: 'user-center',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'getCollections',\r\n\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\tUSERID: uni.getStorageSync('userInfo')._id,\r\n\t\t\t\t\t\t\ttype: this.currentCategory,\r\n\t\t\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\t\t\tpageSize: this.pageSize\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tconsole.log(\"收藏列表\",res)\t\r\n\t\t\t\tif (res.result.code === 0) {\r\n\t\t\t\t\tconst { list, total } = res.result.data\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (this.page === 1) {\r\n\t\t\t\t\t\tthis.collectionList = list\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.collectionList = [...this.collectionList, ...list]\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.noMore = this.collectionList.length >= total\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: res.result.message || '加载失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '加载失败，请稍后重试',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\tconsole.error(e)\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loading = false\r\n\t\t\t\tthis.isRefreshing = false\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 处理分类切换\r\n\t\t */\r\n\t\thandleCategoryChange(category) {\r\n\t\t\tthis.currentCategory = category\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.noMore = false\r\n\t\t\tthis.collectionList = []\r\n\t\t\tthis.loadCollections()\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 加载更多\r\n\t\t */\r\n\t\tloadMore() {\r\n\t\t\tif (!this.loading && !this.noMore) {\r\n\t\t\t\tthis.page++\r\n\t\t\t\tthis.loadCollections()\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 刷新列表\r\n\t\t */\r\n\t\trefresh() {\r\n\t\t\tthis.isRefreshing = true\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.noMore = false\r\n\t\t\tthis.loadCollections()\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 跳转到详情页\r\n\t\t */\r\n\t\tgoToDetail(item) {\r\n\t\t\tlet url = ''\r\n\t\t\tswitch (this.currentCategory) {\r\n\t\t\t\tcase 'scenic':\r\n\t\t\t\t\turl = `/pages/scenic/detail?id=${item._id}`\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'food':\r\n\t\t\t\t\turl = `/pages/food/detail?id=${item._id}`\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'culture':\r\n\t\t\t\t\turl = `/pages/culture/detail?id=${item._id}`\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'guide':\r\n\t\t\t\t\turl = `/pages/guide/detail?id=${item._id}`\r\n\t\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t\tif (url) {\r\n\t\t\t\tuni.navigateTo({ url })\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.collections-container {\r\n\tmin-height: 100vh;\r\n\tbackground-color: #f5f5f5;\r\n\t\r\n\t.category-scroll {\r\n\t\tbackground-color: #fff;\r\n\t\twhite-space: nowrap;\r\n\t\t\r\n\t\t.category-list {\r\n\t\t\tdisplay: flex;\r\n\t\t\tpadding: 20rpx;\r\n\t\t\t\r\n\t\t\t.category-item {\r\n\t\t\t\tpadding: 10rpx 30rpx;\r\n\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tcolor: #666;\r\n\t\t\t\tbackground-color: #f5f5f5;\r\n\t\t\t\tborder-radius: 30rpx;\r\n\t\t\t\t\r\n\t\t\t\t&.active {\r\n\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t\tbackground-color: #007AFF;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t&:last-child {\r\n\t\t\t\t\tmargin-right: 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t.collection-list {\r\n\t\theight: calc(100vh - 100rpx);\r\n\t\tpadding: 20rpx;\r\n\t\tbox-sizing: border-box;\r\n\t\t\r\n\t\t.collection-items {\r\n\t\t\t.scenic-item,\r\n\t\t\t.food-item,\r\n\t\t\t.culture-item,\r\n\t\t\t.guide-item {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tpadding: 20rpx;\r\n\t\t\t\tmargin-bottom: 20rpx;\r\n\t\t\t\tbackground-color: #fff;\r\n\t\t\t\tborder-radius: 12rpx;\r\n\t\t\t\t\r\n\t\t\t\timage {\r\n\t\t\t\t\twidth: 200rpx;\r\n\t\t\t\t\theight: 200rpx;\r\n\t\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.info {\r\n\t\t\t\t\tflex: 1;\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tflex-direction: column;\r\n\t\t\t\t\t\r\n\t\t\t\t\t.name {\r\n\t\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\t\tcolor: #333;\r\n\t\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t.location,\r\n\t\t\t\t\t.description {\r\n\t\t\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\t\t\tcolor: #666;\r\n\t\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t.price {\r\n\t\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\t\tcolor: #ff4d4f;\r\n\t\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t.tags {\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\ttext {\r\n\t\t\t\t\t\t\tpadding: 4rpx 12rpx;\r\n\t\t\t\t\t\t\tmargin-right: 10rpx;\r\n\t\t\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t\t\tfont-size: 22rpx;\r\n\t\t\t\t\t\t\tcolor: #007AFF;\r\n\t\t\t\t\t\t\tbackground-color: rgba(0, 122, 255, 0.1);\r\n\t\t\t\t\t\t\tborder-radius: 4rpx;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t.bottom {\r\n\t\t\t\t\t\tmargin-top: auto;\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\tjustify-content: space-between;\r\n\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t.views {\r\n\t\t\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\t\t\tcolor: #999;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t.loading-status {\r\n\t\t\ttext-align: center;\r\n\t\t\tpadding: 20rpx;\r\n\t\t\t\r\n\t\t\ttext {\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tcolor: #999;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</style> ","import MiniProgramPage from 'D:/programs2024to2025/liululuprogram/first/GuizhouScenicTourismIntroductionSystem/pages/user/collections.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":"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"}