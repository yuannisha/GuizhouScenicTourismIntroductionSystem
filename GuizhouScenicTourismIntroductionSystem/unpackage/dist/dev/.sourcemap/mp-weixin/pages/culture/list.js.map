{"version":3,"file":"list.js","sources":["pages/culture/list.vue","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY3VsdHVyZS9saXN0LnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"culture-list-container\">\r\n\t\t<!-- 搜索栏 -->\r\n\t\t<view class=\"search-bar\">\r\n\t\t\t<input \r\n\t\t\t\ttype=\"text\" \r\n\t\t\t\tv-model=\"searchKeyword\"\r\n\t\t\t\tplaceholder=\"搜索文化\"\r\n\t\t\t\t@confirm=\"handleSearch\"\r\n\t\t\t/>\r\n\t\t\t<button @click=\"handleSearch\">搜索</button>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 分类标签 -->\r\n\t\t<scroll-view scroll-x class=\"category-list\">\r\n\t\t\t<view \r\n\t\t\t\tclass=\"category-item\" \r\n\t\t\t\t:class=\"{ active: currentCategory === index }\"\r\n\t\t\t\tv-for=\"(item, index) in categories\" \r\n\t\t\t\t:key=\"index\"\r\n\t\t\t\t@click=\"handleCategoryChange(index)\"\r\n\t\t\t>\r\n\t\t\t\t{{item}}\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t\t\r\n\t\t<!-- 文化列表 -->\r\n\t\t<scroll-view \r\n\t\t\tscroll-y \r\n\t\t\tclass=\"culture-list\"\r\n\t\t\t@scrolltolower=\"loadMore\"\r\n\t\t\trefresher-enabled\r\n\t\t\t:refresher-triggered=\"isRefreshing\"\r\n\t\t\t@refresherrefresh=\"refresh\"\r\n\t\t>\r\n\t\t\t<view \r\n\t\t\t\tclass=\"culture-item\"\r\n\t\t\t\tv-for=\"(item, index) in cultureList\"\r\n\t\t\t\t:key=\"index\"\r\n\t\t\t\t@click=\"goToDetail(item._id)\"\r\n\t\t\t>\r\n\t\t\t\t<image :src=\"item.images[0]\" mode=\"aspectFill\"></image>\r\n\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t<text class=\"name\">{{item.name}}</text>\r\n\t\t\t\t\t<view class=\"tags\">\r\n\t\t\t\t\t\t<text v-for=\"(tag, tagIndex) in item.tags\" :key=\"tagIndex\">{{tag}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text class=\"description\">{{item.description}}</text>\r\n\t\t\t\t\t<view class=\"bottom\">\r\n\t\t\t\t\t\t<text class=\"views\">{{item.views}}浏览</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 加载状态 -->\r\n\t\t\t<view class=\"loading-status\">\r\n\t\t\t\t<text v-if=\"isLoading\">加载中...</text>\r\n\t\t\t\t<text v-else-if=\"hasMore\">上拉加载更多</text>\r\n\t\t\t\t<text v-else>没有更多了</text>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n/**\r\n * 文化列表页面\r\n * @description 展示文化列表，支持分类筛选和搜索\r\n */\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcategories: ['全部', '民族文化', '历史文化', '饮食文化', '节日文化', '其他'],\r\n\t\t\tcurrentCategory: 0,\r\n\t\t\tsearchKeyword: '',\r\n\t\t\tpage: 1,\r\n\t\t\tpageSize: 10,\r\n\t\t\ttotal: 0,\r\n\t\t\tcultureList: [],\r\n\t\t\tisLoading: false,\r\n\t\t\tisRefreshing: false,\r\n\t\t\thasMore: true\r\n\t\t}\r\n\t},\r\n\tonLoad() {\r\n\t\tthis.loadCultureList()\r\n\t},\r\n\tmethods: {\r\n\t\t/**\r\n\t\t * 加载文化列表\r\n\t\t */\r\n\t\tasync loadCultureList() {\r\n\t\t\tif (this.isLoading || !this.hasMore) return\r\n\t\t\t\r\n\t\t\tthis.isLoading = true\r\n\t\t\tconsole.log(\"当前分类\",this.currentCategory)\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await uniCloud.callFunction({\r\n\t\t\t\t\tname: 'culture-center',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'getCultureList',\r\n\t\t\t\t\t\tparams: {\r\n\t\t\t\t\t\t\tUSERID: uni.getStorageSync('userInfo')._id,\r\n\t\t\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\t\t\tpageSize: this.pageSize,\r\n\t\t\t\t\t\t\tcategory: this.currentCategory ,\r\n\t\t\t\t\t\t\tkeyword: this.searchKeyword\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif (res.result.code === 0) {\r\n\t\t\t\t\tconst { list, total } = res.result.data\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (this.page === 1) {\r\n\t\t\t\t\t\tthis.cultureList = list\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.cultureList = [...this.cultureList, ...list]\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.total = total\r\n\t\t\t\t\tthis.hasMore = this.cultureList.length < total\r\n\t\t\t\t\tthis.page++\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: res.result.message || '加载失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '加载失败，请稍后重试',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t\tconsole.error(e)\r\n\t\t\t} finally {\r\n\t\t\t\tthis.isLoading = false\r\n\t\t\t\tthis.isRefreshing = false\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 处理搜索\r\n\t\t */\r\n\t\thandleSearch() {\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.hasMore = true\r\n\t\t\tthis.loadCultureList()\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 处理分类切换\r\n\t\t */\r\n\t\thandleCategoryChange(index) {\r\n\t\t\tthis.currentCategory = index\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.hasMore = true\r\n\t\t\tthis.loadCultureList()\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 加载更多\r\n\t\t */\r\n\t\tloadMore() {\r\n\t\t\tthis.loadCultureList()\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 刷新列表\r\n\t\t */\r\n\t\trefresh() {\r\n\t\t\tthis.isRefreshing = true\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.hasMore = true\r\n\t\t\tthis.loadCultureList()\r\n\t\t},\r\n\t\t\r\n\t\t/**\r\n\t\t * 跳转到详情页\r\n\t\t */\r\n\t\tgoToDetail(id) {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/culture/detail?id=${id}`\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.culture-list-container {\r\n\tmin-height: 100vh;\r\n\tbackground-color: #f5f5f5;\r\n\t\r\n\t.search-bar {\r\n\t\tdisplay: flex;\r\n\t\tpadding: 20rpx;\r\n\t\tbackground-color: #fff;\r\n\t\t\r\n\t\tinput {\r\n\t\t\tflex: 1;\r\n\t\t\theight: 72rpx;\r\n\t\t\tpadding: 0 20rpx;\r\n\t\t\tbackground-color: #f5f5f5;\r\n\t\t\tborder-radius: 36rpx;\r\n\t\t\tmargin-right: 20rpx;\r\n\t\t}\r\n\t\t\r\n\t\tbutton {\r\n\t\t\twidth: 120rpx;\r\n\t\t\theight: 72rpx;\r\n\t\t\tline-height: 72rpx;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #fff;\r\n\t\t\tbackground-color: #007AFF;\r\n\t\t\tborder-radius: 36rpx;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.category-list {\r\n\t\twhite-space: nowrap;\r\n\t\tpadding: 20rpx;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-bottom: 1rpx solid #eee;\r\n\t\t\r\n\t\t.category-item {\r\n\t\t\tdisplay: inline-block;\r\n\t\t\tpadding: 10rpx 30rpx;\r\n\t\t\tmargin-right: 20rpx;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #666;\r\n\t\t\tbackground-color: #f5f5f5;\r\n\t\t\tborder-radius: 30rpx;\r\n\t\t\t\r\n\t\t\t&.active {\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\tbackground-color: #007AFF;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t.culture-list {\r\n\t\theight: calc(100vh - 220rpx);\r\n\t\t\r\n\t\t.culture-item {\r\n\t\t\tdisplay: flex;\r\n\t\t\tmargin: 20rpx;\r\n\t\t\tpadding: 20rpx;\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tborder-radius: 12rpx;\r\n\t\t\t\r\n\t\t\timage {\r\n\t\t\t\twidth: 200rpx;\r\n\t\t\t\theight: 200rpx;\r\n\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.info {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\t\r\n\t\t\t\t.name {\r\n\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\tcolor: #333;\r\n\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.tags {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t\r\n\t\t\t\t\ttext {\r\n\t\t\t\t\t\tpadding: 4rpx 12rpx;\r\n\t\t\t\t\t\tmargin-right: 10rpx;\r\n\t\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\t\tcolor: #007AFF;\r\n\t\t\t\t\t\tbackground-color: rgba(0, 122, 255, 0.1);\r\n\t\t\t\t\t\tborder-radius: 4rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.description {\r\n\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\tcolor: #666;\r\n\t\t\t\t\tmargin-bottom: 10rpx;\r\n\t\t\t\t\tdisplay: -webkit-box;\r\n\t\t\t\t\t-webkit-box-orient: vertical;\r\n\t\t\t\t\t-webkit-line-clamp: 2;\r\n\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.bottom {\r\n\t\t\t\t\tmargin-top: auto;\r\n\t\t\t\t\t\r\n\t\t\t\t\t.views {\r\n\t\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\t\tcolor: #999;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t.loading-status {\r\n\t\t\ttext-align: center;\r\n\t\t\tpadding: 20rpx;\r\n\t\t\t\r\n\t\t\ttext {\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tcolor: #999;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</style> ","import MiniProgramPage from 'D:/programs2024to2025/liululuprogram/first/GuizhouScenicTourismIntroductionSystem/pages/culture/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":";;AAqEA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,YAAY,CAAC,MAAM,QAAQ,QAAQ,QAAQ,QAAQ,IAAI;AAAA,MACvD,iBAAiB;AAAA,MACjB,eAAe;AAAA,MACf,MAAM;AAAA,MACN,UAAU;AAAA,MACV,OAAO;AAAA,MACP,aAAa,CAAE;AAAA,MACf,WAAW;AAAA,MACX,cAAc;AAAA,MACd,SAAS;AAAA,IACV;AAAA,EACA;AAAA,EACD,SAAS;AACR,SAAK,gBAAgB;AAAA,EACrB;AAAA,EACD,SAAS;AAAA;AAAA;AAAA;AAAA,IAIR,MAAM,kBAAkB;AACvB,UAAI,KAAK,aAAa,CAAC,KAAK;AAAS;AAErC,WAAK,YAAY;AACjBA,oBAAY,MAAA,MAAA,OAAA,gCAAA,QAAO,KAAK,eAAe;AAEvC,UAAI;AACH,cAAM,MAAM,MAAMC,cAAQ,GAAC,aAAa;AAAA,UACvC,MAAM;AAAA,UACN,MAAM;AAAA,YACL,QAAQ;AAAA,YACR,QAAQ;AAAA,cACP,QAAQD,cAAG,MAAC,eAAe,UAAU,EAAE;AAAA,cACvC,MAAM,KAAK;AAAA,cACX,UAAU,KAAK;AAAA,cACf,UAAU,KAAK;AAAA,cACf,SAAS,KAAK;AAAA,YACf;AAAA,UACD;AAAA,SACA;AAED,YAAI,IAAI,OAAO,SAAS,GAAG;AAC1B,gBAAM,EAAE,MAAM,MAAQ,IAAE,IAAI,OAAO;AAEnC,cAAI,KAAK,SAAS,GAAG;AACpB,iBAAK,cAAc;AAAA,iBACb;AACN,iBAAK,cAAc,CAAC,GAAG,KAAK,aAAa,GAAG,IAAI;AAAA,UACjD;AAEA,eAAK,QAAQ;AACb,eAAK,UAAU,KAAK,YAAY,SAAS;AACzC,eAAK;AAAA,eACC;AACNA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO,IAAI,OAAO,WAAW;AAAA,YAC7B,MAAM;AAAA,WACN;AAAA,QACF;AAAA,MACD,SAAS,GAAG;AACXA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,SACN;AACDA,sBAAAA,MAAc,MAAA,SAAA,iCAAA,CAAC;AAAA,MAChB,UAAU;AACT,aAAK,YAAY;AACjB,aAAK,eAAe;AAAA,MACrB;AAAA,IACA;AAAA;AAAA;AAAA;AAAA,IAKD,eAAe;AACd,WAAK,OAAO;AACZ,WAAK,UAAU;AACf,WAAK,gBAAgB;AAAA,IACrB;AAAA;AAAA;AAAA;AAAA,IAKD,qBAAqB,OAAO;AAC3B,WAAK,kBAAkB;AACvB,WAAK,OAAO;AACZ,WAAK,UAAU;AACf,WAAK,gBAAgB;AAAA,IACrB;AAAA;AAAA;AAAA;AAAA,IAKD,WAAW;AACV,WAAK,gBAAgB;AAAA,IACrB;AAAA;AAAA;AAAA;AAAA,IAKD,UAAU;AACT,WAAK,eAAe;AACpB,WAAK,OAAO;AACZ,WAAK,UAAU;AACf,WAAK,gBAAgB;AAAA,IACrB;AAAA;AAAA;AAAA;AAAA,IAKD,WAAW,IAAI;AACdA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,4BAA4B,EAAE;AAAA,OACnC;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1LA,GAAG,WAAW,eAAe;"}